<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Cupones del Restaurante</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>

<div th:replace="~{fragmentos/navbar_user :: navbar_user}"></div>

<div class="container mt-5">

    <h2 class="mb-4">
        Cupones disponibles en:
        <span class="text-success" th:text="${restaurante.nombre}"></span>
    </h2>

    <div th:if="${#lists.isEmpty(cupones)}" class="alert alert-warning mt-3">
        Este restaurante no tiene cupones.
    </div>

    <table class="table table-striped table-bordered" th:if="${!#lists.isEmpty(cupones)}">
        <thead>
            <tr>
                <th>ID Cupón</th>
                <th>Tiempo de duración</th>
                <th>Descuento</th>
				<th>Código</th>		
            </tr>
        </thead>

        <tbody>
            <tr th:each="cupon : ${cupones}">
                <td th:text="${cupon.idCupon}"></td>
                <td th:text="${cupon.tiempoDuracion}"></td>
                <td th:text="${cupon.descuento} + '%'"></td>
				<td>
				     <button class="btn btn-primary"
				             data-bs-toggle="modal"
				             th:attr="data-bs-target='#codigoModal-' + ${cupon.idCupon}">
				         Ver código
				     </button>
				 </td>
            </tr>
        </tbody>
    </table>
	
	

	<!-- MODAL POR CADA CUPÓN -->
	<div th:each="cupon : ${cupones}">
	    <div class="modal fade"
	         th:id="'codigoModal-' + ${cupon.idCupon}"
	         tabindex="-1">
	        <div class="modal-dialog modal-dialog-centered">
	            <div class="modal-content">

	                <div class="modal-header">
	                    <h5 class="modal-title">Código del cupón</h5>
	                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
	                </div>

	                <div class="modal-body text-center">

	                    <h3 class="text-primary fw-bold"
	                        th:text="${cupon.codigo}"></h3>

	                    <p class="mt-3">
	                        ¡Comuníqueselo al empleado encargado del cobro para que aplique el correspondiente descuento!
	                    </p>
	                </div>

	                <div class="modal-footer">
	                    <button type="button" class="btn btn-secondary"
	                            data-bs-dismiss="modal">Cerrar</button>
	                </div>

	            </div>
	        </div>
	    </div>
	</div>


    <a class="btn btn-secondary" th:href="@{/restaurantes}">
        Volver
    </a>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
