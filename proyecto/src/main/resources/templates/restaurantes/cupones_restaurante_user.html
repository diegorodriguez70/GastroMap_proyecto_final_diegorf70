<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Cupones del Restaurante</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/global.css}">
</head>

<style>
    body {
        background-color: var(--gm-light);
        padding-top: 80px;
    }

    h2 {
        color: var(--gm-brown);
        font-weight: 800;
    }

    .table thead th {
        background-color: var(--gm-brown-dark);
        color: white;
        border-color: var(--gm-brown-dark);
    }

    .table tbody tr:hover {
        background-color: var(--gm-light);
    }

    .btn-teal {
        background-color: var(--gm-teal);
        color: white;
        border-radius: var(--gm-radius);
    }
    .btn-teal:hover {
        filter: brightness(0.9);
    }

    .btn-outline-gm {
        border-radius: var(--gm-radius);
        border: 1px solid var(--gm-brown);
        color: var(--gm-brown);
    }
    .btn-outline-gm:hover {
        background-color: var(--gm-brown);
        color: white;
    }

    .modal-content {
        border-radius: var(--gm-radius);
        box-shadow: var(--gm-shadow);
    }

    .modal-header {
        background-color: var(--gm-brown);
        color: white;
        border-top-left-radius: var(--gm-radius);
        border-top-right-radius: var(--gm-radius);
    }

    .modal-footer .btn-secondary {
        border-radius: var(--gm-radius);
    }
</style>

<body>

<div th:replace="fragmentos/navbar_user :: navbar_user"></div>

<div class="container mt-5 mb-5">

    <h2 class="mb-4">
        Cupones disponibles en:
        <span style="color: var(--gm-teal);" th:text="${restaurante.nombre}"></span>
    </h2>

    <div th:if="${#lists.isEmpty(cupones)}" class="alert alert-warning mt-3">
        Este restaurante no tiene cupones.
    </div>

    <table class="table table-bordered table-hover shadow-sm" th:if="${!#lists.isEmpty(cupones)}">
        <thead>
            <tr>
             
                <th>Tiempo de duración</th>
                <th>Descuento</th>
                <th>Código</th>
            </tr>
        </thead>

        <tbody>
            <tr th:each="cupon : ${cupones}">
               
                <td th:text="${cupon.tiempoDuracion}"></td>
                <td th:text="${cupon.descuento} + '%'"></td>

                <td>
                    <button class="btn btn-teal btn-sm w-100"
                            data-bs-toggle="modal"
                            th:attr="data-bs-target='#codigoModal-' + ${cupon.idCupon}">
                        <i class="bi bi-eye"></i> Ver código
                    </button>
                </td>
            </tr>
        </tbody>
    </table>

    <a class="btn btn-outline-gm mt-4" th:href="@{/restaurantes}">
        <i class="bi bi-arrow-left"></i> Volver
    </a>

</div>


<div th:each="cupon : ${cupones}">
    <div class="modal fade"
         th:id="'codigoModal-' + ${cupon.idCupon}"
         tabindex="-1">

        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title">Código del cupón</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body text-center">
                    <h3 class="fw-bold" style="color: var(--gm-teal);" th:text="${cupon.codigo}"></h3>
                    <p class="mt-3">
                        Comunica este código en el restaurante para aplicar el descuento.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary"
                            data-bs-dismiss="modal">Cerrar</button>
                </div>

            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
